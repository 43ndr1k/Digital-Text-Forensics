Stylometric Watermarking
Qian Zhang and Nigel Boston
Department of Electrical and Computer Engineering
University of Wisconsin-Madison US
Abstract
Using stochastic data to identify ownership has a long
history, with stochastic features being used for a variety of
identification applications such as voice print, handwriting
recognition, and authorship attribution. Embedded traits
such as stylistic preferences would help solve the question
of ownership. Even though people sometimes make attempts
to disguise their styles, they are rarely successful. Stylom-
etry, a science of measuring literary style is often used in
authorship attribution. A written piece is analyzed using
statistics, math formulas and artificial intelligence to deter-
mine the “style” of an author’s writing. The stylometric
watermarking proposed in this paper tries to model the sty-
lometry and apply it to digital watermarking. In the stylo-
metric watermarking, the watermark is no longer determin-
istic, but stochastic, or a style.
1 Introduction
Using stochastic data to identify ownership has a long
history, with stochastic features being used for a variety
of identification applications such as voice print, handwrit-
ing recognition, and authorship attribution. In 1995, Pri-
mary Colors, a controversial best seller whose author was
listed only as ”Anonymous,” was published.(Washington
Post, July 17, 1996). Donald Foster, an English profes-
sor at Vassar College compared Primary Colors and known
writings by Joe Klein’s, a famous political columnist, found
similarities-Foster focused on a list of adverbs used by both
Klein and Anonymous. However, Klein still denied au-
thorship. Six months later, an early manuscript containing
brief snatches of handwriting on several pages was found
by the booksellers. A top handwriting analyst, Maureen
Casey Owens, compared the handwriting with samples of
Joe Klein’s and concluded that ”the two samples of hand-
writing are absolutely consistent throughout”(Washington
Post, July 17, 1996). Only then did Joe Klein admit that he
was ”Anonymous”.
Handwriting is as unique and almost as unchangeable
as fingerprints. Even though people sometimes make at-
tempts to disguise their writing, they are rarely successful.
There are no two signatures which are exactly alike; how-
ever styles can be very similar, such as the angle of the writ-
ing, the manner in which the letters are formed, or the force
of the pen on the page. Such a style is expressed quan-
titatively as some statistical parameters. Stylometry[1],the
method Professor Foster adopted, is defined as the statisti-
cal analysis of literacy style. Stylometry assumes that an
author has distinctive writing habits in the format of the
author’s core vocabulary usage, sentence complexity and
phraseology. Certain ”watermarks” exist unconsciously and
are deeply ingrained and hard to disguise. Researchers have
developed an arsenal of mathematical tools, from statistical
tests to artificial intelligence techniques, for use in deter-
mining authorship. They have started applying these tools
to texts from a wide range of literary genres and time peri-
ods, including the Federalist Papers, Civil War letters, and
Shakespeare’s plays.
From the above examples, a common feature of the
forensic schemes is a unique style unveiling the owner’s
identity, which is embedded in the voice, handwriting, doc-
uments, etc.. The style is hidden in a very secret way but ex-
ists everywhere and marks ownership. In the current water-
marking schemes such as spread spectrum watermarking[2]
and the multiplicative watermark [3], the watermark is de-
terministic and needs to be known for the watermark extrac-
tion. The point of this paper is that the watermark needs not
be deterministic - it can be a style, embedded in statistical
characteristics.
2 The Stylometric Watermarking Scheme
In this paper we try to bring the stylometric concept
into the watermarking world. In text authorship, stylom-
etry attempts to define the features of an authors style
and to determine statistical methods to measure these fea-
tures so that the similarity between two or more pieces
of text can be analysed[4]. The handwriting recognition
has a similar process which usually involves segmentation,
feature extraction, and classification. The decision meth-
International Conference on Intelligent Information Hiding and Multimedia Signal Processing
978-0-7695-3278-3/08 $25.00 © 2008 IEEE
DOI 10.1109/IIH-MSP.2008.59
477
ods includes statistical methods,neural networks,structural
matching (on trees, chains, etc.) and stochastic process-
ing (Markov chains, etc.). Hidden Markov models (HMMs)
is the basis of modern speech recognition and handwriting
recognition systems. Those techniques can be adapted to
the watermarking. The encoding of stylometric watermark-
ing can be regarded as the reverse process of the above. A
style is defined and carried in the host signals. The decoding
process is similar to the recognition process.
Let us take a simple example in binary image watermark.
A simple feature can be that the number of consecutive “0”
follows a pattern. For instance, the even numbers of consec-
utive “0” can represent 1; the odd numbers of consecutive
“0” represents 0. The numbers of consecutive “0” are mod-
ified according to the style. It could be a pseudo random
number generated by a Markov Chain. The style is actu-
ally the markov chain matrix entry pij which is defined as
pi,j = Pr(Xt+1 = j|Xt = i), where xi ∈ {0, 1} When the
receiver gets the document, he only needs to check whether
the pattern(the style) exists or not.
The receiver would like to estimate the actual style,i.e.
the transition matrix from the data.The encoded data Xn =
{x0, x1, ...xn}. Define nij be the number of times i is fol-
lowed by j. The likelihood is
l(p) = log px0 +
∑
i,j
nij log pij
Using the maximum likelihood estimation,
arg max
pij
l(p) s.t.
∑
pij = 1
The estimation of pij is p̂ij =
nij∑
j nij
.
Suppose we have {P0, . . . , Pm} styles, the embedded
style can be get by n = arg mini=0,...,m ||P̂ − Pi||. Let
us generalized this idea. Suppose we have a metric space
X , with metric d and measure m on it, and that also is a
group under addition. The formal definition of the stylo-
metric watermarking system is
Definition 2.1 A stylometric watermarking scheme. A
watermarking of X is defined to be a map f : X → X
such that f(x) is close to x for every x ∈ X . Given a
watermarking f we can get a watermark p as follows. For
each w ∈ X , let Z(w) = {x ∈ X : f(x) − x = w}. Let
p(w) = m(Z(w)) or p(w) = m(f(x)).
x is the feature of the image. In the above example, x is
the number of consecutive “0”s. The encoder modifies the
x according to a pseudo random sequence. The watermark
is the transition matrix pij of the watermarked signal f(x).
3 Stylometric on Image Watermarking
Among all the current watermarking schemes, spread
spectrum watermarking and the multiplicative watermark
are very popular. In the spread spectrum watermarking
scheme, a pseudo-random sequence is added to the host sig-
nals y = x + θs, where x is the host signal, s is the water-
mark, θ is the embedding strength, and y is the watermarked
signal. In the multiplicative watermark, the watermark is
embedded in a multiplicative way, i.e., y = x(1 + θs). In
both algorithms, the watermark s is deterministic and is nec-
essary to be known for the watermark extraction. In this
paper, we are trying to extend these kind of current water-
marking schemes from embedding a fixed, known sequence
to embedding a sequence of stochastic data, which has a
long history of ownership identification applications.
3.1 The Watermark Model
w = {w0, . . . , wn} is the actual embedded watermark,
which could be complete known,a known waveform except
for a few random parameters or a pure stochastic waveform.
The embedded signal can be either totally independent of
the host signals or related to the host signals.
Assumption 1 The average power and the peak power of
signal wi satisfy:
1. The asymptotic average signal power is finite and
nonzero, 0 < limn→∞ 1n
∑n
i=1 w
2
i < ∞
2. There exists a finite,non-zero bound U such that 0 ≤
|wi| ≤ U, i = 1, 2, . . .
Traditionally, most watermarks are fixed.This paper ex-
tends the deterministic watermarks to be stochastic water-
marks, which we expect thereby to be more secure. Even
though a large sample of statistical data maybe needed,
however, it is not a matter for security purpose watermark-
ing applications, when the payload is not a big concern.
3.2 The Host Signal Model
Image watermarks are usually embedded in the image
frequency domain, which has an accurate statistical model.
If the watermarks are embedded in the mid-range of the im-
age frequency domain (DCT,DWT,DFT, etc.), the host sig-
nals (block DCT and DWT coefficients) are usually mod-
eled as independent, identically distributed random vari-
ables with the generalized Gaussian distribution. The mag-
nitudes of the DFT coefficients are modeled as independent,
identical, Weibull-distributed random variables [3, 5, 6].
Assumption 2 Let p(x) be the probability density function,
x ∈ X , and satisfy the following assumptions:
1. p′(x) exists a.e. and satisfies
∫ ∞
−∞ |p′(x)|dx < ∞.
2. p′′(x) exists a.e. and satisfies
∫ ∞
−∞ |p′′(x)|dx < ∞.
478
3. The Fisher Information
IFisher = E(
d log p(x)
p(x)
)2dx =
∫ ∞
−∞
[
p′(x)
p(x)
]2p(x)dx < ∞
3.3 A General Detection
Let x be the host signal, y be the watermarked signal;
the watermark si is embedded in the host signal by y =
x + θg(si, x), where θ is close to 0. g(s, x) is usually of
the form g(si, x) = si or g(si, x) = six. Without loss of
generality, consider only the binary case.
H0 : y = x
H1 : y = x + θg(s, x) = f(x, s, θ) (θ > 0)
Lemma 1 Let the probability density function of host sig-
nal x be pX(x). Given the watermark s, and f(x, s, θ),
which is a single valued function with continuous partial
derivatives and invertible, the conditional probability den-
sity function of y = f(x) is
pY (y|s) = pX(f−1(y, θ))|∂f
−1(y, θ)
∂y
|
= pX(y)(1 + (s, y)θ) (1)
where
(s, y) = −[g(s, y)
pX(y)
∂pX(x)
∂x
|x=y +
∂g(x, s)
∂x
|x=y]sgn(∂f
−1(y, θ)
∂y
) + O(θ)
sgn(x) is the sign function. O(θ) is the remainder.
lim supθ→0 O(θn)/θn < ∞.
Lemma 2 Let the probability density function of host sig-
nal x be pX(x), the probability density function of water-
mark s be pS(s). Then the probability density function of
y = f(x) is pY (y) = pX(y)(1 + θ
∫
(s, y)pS(s)ds) =
p(y)(1 + θ̄(s, y))
Lemma 1 and Lemma 2 point out the fact that the wa-
termark only has a little effect on the distribution of host
signals. The energy of the watermark is very small,and the
watermark won’t significantly change the probability den-
sity function parameters. The parameters of the host signals
can be estimated by the watermarked signals [6]. The log
likelihood ratio test statistic is:
log
p1(y)
p0(y)
= log[1 + θ̄(si, y)] ≈ θ̄(si, y) (2)
4 Additive Stylometric Watermark Detection
g(s, x) = s is called additive watermarking. Without
loss of generality, we only consider the detection of a given
watermark S. The binary hypothesis model is
H0 : pH0(Y ) = pX(Y )
H1 : pH1(Y ) =
∫
S
pX(Y − θS)dF (S) (3)
The noise X is assumed to be independent identically dis-
tributed random variable with pdf pX(X). The distribution
of S is F (S).
4.1 Case A: S̄ = 0
When S̄ = 0, S is either a deterministic nonzero symbol,
or a stochastic process with non-zero mean.
If θ is very small, close to 0, we can truncate the higher
orders, and simply compare the first order term. The de-
cision statistic of the maximum likelihood test can be ex-
pressed as
L(Y ) = − S̄ · ∇pX(Y )
pX(Y )
(4)
The Chernoff Information is defined as
C(pH1(Y ), pH0(Y ))
≈ θ
2
8
S̄T
∫
Y
∇pX(Y )∇T pX(Y )p−1X (Y )dY S̄ (5)
4.2 Case B: S̄ = 0,
∫
S
ST SdF (S) = 0
When S̄ = 0, S is a zero mean stochastic process.
The probability of observed signal Y under hypothesis
H1 is
pY (Y |H1) = pX(Y ) + 12θ
2
∫
S
ST [∇X(∇XpX(X))p−1X (X)]X=Y SdF (S)
The decision statistic of the maximum likelihood test is
equivalent to
L(Y ) =
∫
S
ST [∇X(∇XpX(X))p−1X (X)]X=Y SdF (S) (6)
When xi is independent identically distributed, i.e.
pX(X) =
∏N−1
i=0 px(xi), Eqn. 6 is
L(Y ) =
∑
i
s2i
p′′(yi)
p(yi)
+
∑
i=j
∑
j
sisj
p′(yi)p′(yj)
p(yi)p(yj)
(7)
If the si is independent, Eqn. 7 is L(Y ) =
∑
i s
2
i
p′′(yi)
p(yi)
479
Lemma 3 The Chernoff bound is
C(pH1(Y ), pH0(Y )) = max
0≤t≤1
log[1 − mθ4t(t − 1) + O(θ5)]
where
m =
1
8
∫
Y
[
∫
S
ST∇X(∇XpX(Y ))SdF (S)]2p−1X (Y )dY ]
5 Simulation Results
In the following simulations we embed a watermark in
the 512 × 512 Baboon image. The watermark is embed-
ded in the DCT coefficients {C0,1,0}, which is a generalized
Gaussian distribution with ν = 1.0240,σ = 63.1503. si is
randomly generated from a distribution with E(si) = µi,
µi ∈ {µ,−µ},var(si) = σ2s = µ2. α = µ/σ = 0.05. We
use StirMark[7] as attack tools. The likelihood statistic is
L(x) = 1N
∑ p′(x)
p(x) sgn(µ). The stirmark attacks have ap-
plied on the watermarked images. The results are listed in
Fig. 1. This embedding algorithm is very robust for JPEG
compression and median filter. The embedding algorithm is
pretty robust for removal of lines attack and rescale attack.
The frequency of row and column removal goes from 10 to
100, the rescale ratio is [50 75 90 110 150 200].
10 20 30 40 50 60 70 80 90 100
−1
−0.5
0
0.5
1
1.5
2
x 10
−3 JPEG
JPEG Quality
D
et
ec
tio
n 
S
ta
tis
tic
s 
L
Baboon
WM
Baboon
Threshold for watermarked Baboon
Threshold for Baboon without watermark
3 4 5 6 7 8 9
0
0.5
1
1.5
2
2.5
x 10
−3 MEDIAN
Median Filter Window size MxM
D
et
ec
tio
n 
S
ta
tis
tic
s 
L
Baboon
WM
Baboon
Threshold for watermarked Baboon
Threshold for Baboon without watermark
10 20 30 40 50 60 70 80 90 100
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
x 10
−3 REMOVAL OF LINES
The Frequency of Row and Column Removal
D
et
ec
tio
n 
S
ta
tis
tic
s 
L
Baboon
WM
Baboon
Threshold for watermarked image
Threshold for Baboon without watermark
50 100 150 200
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
x 10
−3 RESCALE
Rescale Ratio
D
et
ec
tio
n 
S
ta
tis
tic
s 
L
Baboon
WM
Baboon
Threshold for watermarked Baboon
Threshold for Baboon without watermark
Figure 1. Upper Left:Robustness of Ba-
boon Against JPEG Compression.Upper
Right:Robustness of Baboon Against Me-
dian Filter Attack ,Lower Left:Robustness
of Baboon Against Rescale Attack, Lower
Right:Robustness of Baboon Against Re-
moval of Lines Attack,
6 Conclusion
This paper proposes a new watermarking
method:Stylometric watermarking. And examples are
discussed in image watermarking field. The Stylometric
can also be used in video watermarking. The shift cipher
cryptanalysis based watermarking proposed in [8] spreads
a sequence of statistical data through the temporal axis.
In this method watermark is no longer deterministic but
stochastic. In game theory mix strategy is a strategy
consisting of possible moves and a probability distribution
(collection of weights) which corresponds to how fre-
quently each move is to be played. A player would only use
a mixed strategy when she is indifferent between several
pure strategies, and when keeping the opponent guessing
is desirable - that is, when the opponent can benefit from
knowing the next move. The stylometric watermark is a
mix strategy watermarking. Further discussions about how
to design stochastic watermark are needed.
References
[1] M. W. Corney, “Analysing e-mail text authorship for
forensic purposes, master thesis,” 2003.
[2] F. Hartung; J. K. Su and B. Girod, “Spread spectrum
watermarking: Malicious attacks and counterattacks,”
in in Security and Watermarking of Multimedia Con-
tents, Proc. SPIE, Jan 1999, vol. 3657.
[3] Q. Cheng; T.S. Huang, “Robust optimum detection of
transform domain multiplicative watermarks,” Signal
Processing, IEEE Transactions on [see also Acoustics,
Speech, and Signal Processing, IEEE Transactions on],
vol. 51, pp. 906–924, April 2003.
[4] D. I. Holmes, Authorship Attribution, Computers and
the Humanities, 1994.
[5] M. Barni; F. Bartolini; A. De Rosa and A. Piva, “A
new decoder for the optimum recovery of nonadditive
watermarks,” Image Processing, IEEE Transactions on,
vol. 10, pp. 755 – 766, May 2001.
[6] M. Barni; F. Bartolini; A. De Rosa and A. Piva, “Op-
timum decoding and detection of multiplicative water-
marks,” Signal Processing, IEEE Transactions on, vol.
51, pp. 1118 – 1123, April 2003.
[7] F. A. P. Petitcolas; R. J. Anderson; M. G. Kuhn, “At-
tacks on copyright marking systems,” in Informa-
tion Hiding, Second International Workshop, IH98,
Portland, Oregon. April 1998, pp. 219–239, Springer-
Verlag.
[8] Q. Zhang and N. Boston, “A cryptanalytic method for
embedding video watermarks,” in ICASSP, 2005.
480
