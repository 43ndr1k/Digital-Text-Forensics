SECURITY AND COMMUNICATION NETWORKS
Security Comm. Networks (2016)
Published online in Wiley Online Library (wileyonlinelibrary.com). DOI: 10.1002/sec.1412RESEARCH ARTICLE
A novel approach for spam email detection based on
shifted binary patterns
Yılmaz Kaya1* and Ömer Faruk Ertuğrul2
1 Department of Computer Engineering, Siirt University, 56100 Siirt, Turkey
2 Department of Electrical and Electronics Engineering, Batman University, 72100 Batman, TurkeyABSTRACT
Advances in communication allow people flexibility to communicate in various ways. Electronic mail (email) is one of the
most used communication methods for personal or business purposes. However, it brings one of the most tackling issues,
called spam email, which also raises concerns about data safety. Thus, the requirement of detecting spams is crucial for
keeping the users safe and saving them from the waste of time while tackling those issues. In this study, an effective
approach based on the probability of the usage of the characters that has similar orders with respect to their UTF-8 value
by employing shifted one-dimensional local binary pattern (shifted-1D-LBP) was used to extract quantitative features from
emails for spam email detection. Shifted-1D-LBP, which can be described as an ordered set of binary comparisons of the
center value with its neighboring values, is a content-based approach to spam detection with low-level information. To
validate the performance of the proposed approach, three benchmark corpora, Spamassasian, Ling-Spam, and TREC email
corpuses, were used. The average classification accuracies of the proposed approach were 92.34%, 92.57%, and 95.15%,
respectively. Analysis and promising experimental results indicated that the proposed approach was a very competitive fea-
ture extraction method in spam email filtering. Copyright © 2016 John Wiley & Sons, Ltd.
KEYWORDS
spam email detection; shifted binary patterns; feature extraction; automated text categorization
*Correspondence
Yılmaz Kaya, Department of Computer Engineering, Siirt University, 56100 Siirt, Turkey.
E-mail: yilmazkaya1977@gmail.com1. INTRODUCTION
One of the cheapest and the most popular forms of
communication has been email for the last two decades
along with advances in internet technologies [1]. The
use of email is spreading among the world population
and being used by billions of people now, which makes
it at the core of trade. Therefore, it is a potential tool
for virus attacks and spams. Spam, which makes up a
major part of email traffic and is a component of our
daily lives, has become an important trouble for both
users and internet traffic [2–5]. Additionally, Çıtlık
and Güngör reported that there is a waste of time for
personal users in deciding whether incoming emails
are spam or non-spam and also a lack of bandwidth.
To solve these drawbacks, some technical and legal
measures are applied. However, spam email is generally
seen as earning money, weight losing, business incuba-
tion, finding a friend, advertisement of adult entertain-
ment products and make-money-quick schemes [6,7].Copyright © 2016 John Wiley & Sons, Ltd.The problem is getting more and more serious day
by day.
Therefore, finding various techniques in detecting spam
emails or in filtering them is still a popular research area.
Different techniques have been adopted to stop the threat
of spam emails, and some of them drastically reduce the
amount of spam that attacks internet users across the
world. While some methods check the address of the in-
coming email from the blacklist, some others make the
email context investigation against specific keywords [3].
Although, keyword-based methods are reported to have
satisfactory performance, they are not deemed as sufficient
[8]. The context-based spam email-detection approaches
are built on how a word w1 influences the occurrence of
another word w2 in the message. Thus, the presence or ab-
sence of w1 affects a classification based on w2. Even
though Nakov and Dobrikov [9] and Chakravarty [10]
have reported techniques and algorithms for finding rele-
vancy among words, significant work has not yet been car-
ried out in the field of context-based email classification.
A novel approach for spam email detection Y. Kaya and Ö. F. ErtuğrulAnother alternative approach is statistical ones. These ap-
proaches are based on the word occurrences, that is, fre-
quency of one or more words in a given message.
Several algorithms, which are based on this approach, have
been employed successfully [11,12]. In addition to these
approaches, machine-learning methods showed a satisfac-
tory success in filtering spam email because they do not
need any start-up hypothesis (learning in the training pro-
cess). Therefore, they have been used extensively in recent
years [4,6,13,14]. Basically, spam email detection or filter-
ing process via machine-learning methods can be seen as a
classification of emails into the spam or non-spam classes
according to the content of emails [15–18]. The feature ex-
traction plays an important role in this process, because the
accuracy of the classification will be degraded if the fea-
tures are not chosen well [19]. The aim of this study was
to present and validate a new approach, which differs from
the previous works in the literature of spam detection.
The motivation behind this study is to investigate
whether the advantages of the context-based and
statistical-based feature extraction methods can be com-
bined with a novel approach, which also can utilize the
classification power of machine-learning methods. Therefore
in this study, an effective approach, which is based on the
probability of the character orders by employing shifted
one-dimensional local binary pattern (shifted-1D-LBP),
was used to extract quantitative features from an email for
identifying whether it as a spam or not. Shifted-1D-LBP,
which has many improvements, can be defined as a statisti-
cal approach that extracts representative features from
emails. The proposed approach uses the Unicode values of
the characters and compared them with their neighbors; it
takes 0 or 1, depending on whether it has a smaller or larger
value than their central value. Next, the obtained binary
values, after comparison, are converted to decimal numbers
and they were used instead of the text. Finally, the obtained
decimal values formed a histogram, which is used as a fea-
ture vector. Shifted-1D-LBP is based on two parameters, PL
and PR, which determine the neighbors that will be taken into
account. Also by this way, different patterns can be obtained,
which can be used to define various filters for spam email de-
tection. Additionally, it has a high speed of feature extraction.
One of the most important advantages of shifted-1D-LBP is
its computational simplicity, which makes it possible to be
employed in real-time text processing applications. To the
best of our knowledge, this is a novel approach in literature
for spam email detection; because it is a text-based feature
extraction method based on the order of characters in the
text. In classification stage, Fisher linear discriminant
analysis (FLDA), Naïve Bayes (NB), BayesNet (BN), func-
tional tree (FT), random tree (RT), and random forest (RF)
methods with 10-fold cross-validation were employed to
shifted-1D-LBP features.
The outline of the paper is as follows. The collection of
the data sets is provided in Section 3. Feature extraction
based on shifted-1D-LBP is presented in Section 4. Exper-
imental results are reported in Section 5, and conclusions
are drawn in Section 6.2. RELATED STUDIES
Spam filtering methods can be categorized into two
groups depending on utilization from machine-learning
methods or not. Most of the early methods belonged to
the non-machine learning-based methods. The author,
content, and body or header of each email is analyzed
against blacklists, generally by using bag-of words, n-gram,
and character-frequencies methods. Unlike these ap-
proaches, machine-learning techniques analyze the content
of the email and classify accordingly. Therefore, they can
be utilized more effectively in spam email filtering.
Recently, several different techniques have been applied
to detect and filter the spam email. In Table I, we provide
a comprehensive list of the spam filtering algorithms
proposed in the literature. An overview of these methods
can be found in Blanzieri and Bryl [20] and Guzella and
Caminhas [4].3. DATA SETS
To make a fair comparison, three publicly available spam
corpora were used to validate the accuracy of the features
extracted by the proposed, shifted-1D LBP approach. The
essential properties of these three corpora are summarized
as follows:
(1) SpamAssassinCorpus [41]: It contains 4150non-spam
and 1897 spam emails and it consists of five parts:S
(a) spam: 500 spam emails, which were received
from non-spam trap sources.
(b) easy_ham: 2500 non-spam emails, which can
be easily differentiated from spam emails.
(c) hard_ham: 250 non-spam emails, which were
closer to typical spam in many respects.
(d) easy_ham_2: 1400 more recent non-spam emails.
(e) spam_2: 1397 more recent spam emails.(2) The second corpus is Ling-Spam corpus, which
consists of 2412 Linguist emails that was obtained
by randomly downloading digests from the ar-
chives, separating their emails, and removing text
added by the server, and 481 of the spam emails
were received by Androutsopoulos [42]. The attach-
ments, HTML tags, and duplicate spam emails,
which were received on the same day, were ex-
cluded. As a result, the 16.6% of the corpus is spam.
There are four versions of Ling-Spam corpus, and
we used the most general version of it (bare ver-
sion). Additionally, the emails of corpus contain
only the body and the subject and there is no header.
(3) The last corpus is public spam corpora of the 2006
text retrieval conference (TREC). TREC’s Spam
Track uses a standard testing framework that pre-
sents a set of chronologically ordered email mes-
sages and a spam filter for classification [43,44].ecurity Comm. Networks (2016) © 2016 John Wiley & Sons, Ltd.
DOI: 10.1002/sec
Table I. Spam filtering algorithms proposed in literature.
Method Author(s)/Year Reference
Naïve Bayes Schneider (2003), Graham (2003), Androutsopoulos et al. (2004),
Zhang et al. (2004), Marsono et al. (2009)
[21–25]
Flexible Bayes Androutsopoulos et al. (2004) [23]
Maximum entropy model Zhang et al.(2004) [24]
Support vector machines Wang (2005), Sculley and Wachman (2007), Blanzieri and Bryl (2007) [26–28]
Centroid-based Soonthornphisaj et al. (2002) [29]
Clustering methods Sasaki and Shinnou (2005) [30]
n-grams Medlock (2006) [31]
Rough set-based model Zhao and Zhang (2005), Kaya et al. (2011) [32,33]
Smoothed N-gram Medlock (2006) [31]
SMTP-path analysis Leiba et al. (2005) [34]
Extreme learning machine Kaya et al. (2014) [35]
Logistic regression Goodman and Yin (2006) [36]
Artificial neural network Wu and Tsai (2009), El-Alfy and Abdel-Aal (2011), Su et al. (2010) [6,16,37]
Artificial immune systems Wang et al.(2006), Yue et al.(2007) [11,12]
Rule-based classifiers Wu (2009) [9]
Decision trees Ying et al. (2010) [38]
Behavior-based features Yue et al. (2007) [39]
IP, MX, and DNS records and zones Leiba et al. (2005), Hershkop (2006) [34,40]
A novel approach for spam email detectionY. Kaya and Ö. F. Ertuğrul
Se
DOThe corpora consisted of two English and Chinese
sub corpuses. In this study, English corpus was
used. The data set contains 37 822 emails, of which
12 910 are non-spam and 24 912 are spam emails.4. METHODS
4.1. Shifted binary patterns
The shifted-1D-LBP approach, which was developed from
the local binary pattern method (LBP), was employed for
extracting features from emails. The LBP operator, which
was proposed to measure the local contrast in texture anal-
ysis [45], tries to detect micro-textons in a local region.
The basic process of shifted-1D-LBP is quite similar to
the texture operator, LBP. They differ from each other de-
pending on the selection of neighbors. It analyzes the
neighborhood of samples in the series sequentially. For
each character sample in a message, a binary code is pro-
duced by thresholding its Unicode value with the value
of its determined neighbors. This procedure is iteratively
realized across the entire message [46].
In this study, the traditional 1D-LBP was improved by
shifting the neighbors for having an adaptable method in get-
tingmicro andmacro patterns. Shifted-1D-LBPPL,PRwas used
for feature extraction, where P (PL+PR) denotes the totalFigure 1. The flowchart of shifted one
curity Comm. Networks (2016) © 2016 John Wiley & Sons, Ltd.
I: 10.1002/secnumber of neighbors that will be taken into consideration in
both sides of the central point, PL denotes the number of
neighbors that will be taken in the left side of the central point
and PR defines the total number of neighbors that will be
taken from the right side of the central point. For a given po-
sition, the shifted-1D-LBP operator is defined as an ordered
set of binary comparisons of the center value and its neighbor-
ing values. For each point of the message, P (PL+PR) neigh-
bors are considered by the left and right sides of the center
point as seen in Figure 1.
After converting the text message into Unicode and
assigning PL and PR, the neighbors are compared with Pc.
For example if PL=3 and PR=5, the value of the neighbor-
ing three is taken in the left PL= (P0, P1, P2) and the other five
in the right side PR= (P3, P4, P5, P6, P7) of each center point
(Pc). Figure 2 shows a sample point on the message.
As in Figure 2, all neighboring values P={P0, P1, P2, P3,
P4, P5, P6, P7} are compared with the central value (Pc). If the
neighboring Pi value is greater than or equal to the center
value, this Pi value takes 1 otherwise 0. Then, the obtained bi-
nary number is converted to a decimal number, and a shifted-
1D-LBP value for this data point is formed. Figure 3 shows
the comparison at a given message position.
The decimal value of this binary code represents the local
structural information around the given Pc as seen in Figure 3.
The aforementioned stages are performed for each character in
the message. By applying this procedure, a shifted-1D-LBP-dimensional local binary pattern.
rem
Afte
it is
Figure 2. Sample point on signal.
Figure 3. Comparison of Pc with neighbors (Pi).
A novel approach for spam email detection Y. Kaya and Ö. F. Ertuğrulsignal is formed, which has values ranging between 0 and
255 if P takes the value of 8. Each shifted-1D-LBP value
corresponds to a different pattern. The histogram of the
shifted-1D-LBP signal shows how often each of these 256
different patterns appears in a given message. In this study,
the shifted-1D-LBP operator is used to produce a histogram,
which is used as an alternative representation of the text
signals. The formulation of shifted-1D-LBP is given as
t ¼ Pi  Pc
Shifted 1D LBP xð Þ ¼
XP
i¼0
Sign tð Þ2i1
Sign ¼
1; t ≥ 0
0; t < 0
( (1)
where Pi and Pc represent the number of neighbors, center
point, respectively.4.2. The spam identification method
Here, a totally different approach was proposed in feature
extraction from emails for spam email detection. This fea-
ture extraction method is based on the probability of the
use of the characters that has the similar order with respect
to their UTF-8 value, that is, it extracts features based on
the changes of the characters in the email texts. An email
message usually consists of the message or body, which
is usually in the form of plain text. The proposed method
was employed in body parts of messages. The block dia-
gram pertaining to this model is shown in Figure 4.
The process of the blocks in Figure 4 can be summa-
rized as follows briefly.
Block 1: In this block, special characters, such as punctu-
ation, the blank, carriage return, and newline characters,
are removed and the remaining part is converted to
Unicode, which may be considered as a one-
dimensional signal. For example, for the messageS
“A novel approach for spam email de-
tection based on binary patterns”First, after the unwanted characters were removed, the
aining message is“Anovelapproachforspamemaildetectio-
nbasedonbinarypatterns”ecr the conversion of the message to UTF-8 codes,“65 110 111 118 101 108 97 112 112 114
111 97 99 104 102 111 114 115 112 97
109 101 109 97 105 108 100 101 116 101
99 116 105 111 110 98 97 115 101 100
111 110 98 105 110 97 114 121 112 97
116 116 101 114 110 115”Block 2: The features from emails were extracted by
employing shifted-1D-LBP as explained in the previous
section. By applying this procedure, a 1D-LBP signal is
formed, which has values ranging between 0 and 255 for
P=8, and different PL, PR values are illustrated in Figure 5.
Determining neighbors for different shifted-1D-LBP
parameters was demonstrated in Figure 5, as seen, forurity Comm. Networks (2016) © 2016 John Wiley & Sons, Ltd.
DOI: 10.1002/sec
Figure 4. The block diagram of the proposed spam email detection method. 1D-LBP, one-dimensional local binary pattern.
Figure 5. Selecting neighbors stage in obtaining a signal of a sample message for P = 8 and different PL, PR values.
A novel approach for spam email detectionY. Kaya and Ö. F. Ertuğruleach value of any PL and PR parameter the obtained
1D-LBP decimal values are changed; therefore, the
possibility of detecting hidden patterns is increased in
this way.
Blocks 3–4: The histogram of transformed 1D-LBP sig-
nal, which shows how often each pattern appears in its
corresponding signal, was determined in this block.
There are 256 features in shifted-1D-LBP for classifica-
tion methods if P takes the value of 8.
Block 5: In the classification stage, different classifica-
tion techniques such as FLDA, NB, BN, FT, RT and
RF methods were employed to classify the obtained fea-
tures by the shifted-1D-LBP into two classes: spam or
non-spam with 10-fold cross-validation.4.3. Criteria for performance evaluation
To evaluate and compare the accuracy of the proposed
model, statistical quality measures (recall, precision,
accuracy, Matthews correlation coefficient (MCC),
f-measure (the weighted harmonic mean of precision
and recall) and receiver operating characteristic (ROC)
area (true positive rate plotted against false positive rate)
rates) were used. These measures are widely adopted in
evaluating spam email classification techniques [47–49].
These rates are defined as follows:Security Comm. Networks (2016) © 2016 John Wiley & Sons, Ltd.
DOI: 10.1002/secAccuracy Rate ¼ NTP þ NTN
NF þ NT (2)
Precesion Rate ¼ NTP
NFN þ NTP (3)
Precesion Rate ¼ NTP
NFP þ NTP (4)
F Measure ¼ 2NTP
2NTP þ NFP þ NFN (5)
MCC ¼ NTPNTN  NFPNFNffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi
NTP þ NFPð Þ NTP þ NFNð Þ NTN þ NFPð Þ NTN þ NFNð Þ
p
(6)
where NT is the total number of spam emails, NF is the
total number of non-spam emails, NTP is the total num-
ber of correctly classified spam emails, NFP is the total
number of non-spam emails that are falsely classified as
spam emails, and NFN is the total number of spam emails
that are falsely classified as non-spam emails. A false
positive falsely classified a non-spam email as a spam,
and a false negative mistakenly classified a spam as a
non-spam email. A spam marked as non-spam will leave
a burden on the users who need to read through and de-
lete it. However, a non-spam email that is marked as
spam is usually followed by the sequence of automatic
deletion causing the user to lose important email. There-
fore, the cost of a false positive is much higher than that
A novel approach for spam email detection Y. Kaya and Ö. F. Ertuğrulof a false negative. The existence of false positives de-
stroys the faith of the user in their spam email filter be-
cause email users tend to delete spam email from a bulk
folder without reading them, and deleting non-spam
emails (due to spam filters) is unacceptable. In that case,
it is acceptable to allow some false negatives rather than
having any false positives.5. RESULTS AND DISCUSSION
In this paper, a novel approach has been proposed for text
based on spam email identification. The proposed method,
shifted 1DLBPPL,PR, was used for extracting features
from email texts. By applying the method, a shifted-1D-LBP
signal is formed, which has values ranging between 0 and
255 if P takes the value of 8. Each shifted-1D-LBP value
corresponds to a different pattern. The histogram of the
shifted-1D-LBP signal shows how often each of these 256
different patterns appear in a given message. The obtained
histograms by applying shifted-1D-LBPPL=3,PR=5 method
to spam and non-spam emails, which are the same length,
are provided in Figure 6.
When Figure 6 carefully examined the patterns obtained
for spam and non-spam, classes seem different. Obtained
average accuracies of spam email detection with different
machine-learning methods: FLDA, NB, BN, FT, RT,
and RF methods with 10-fold cross-validation of the
1D LBPPL,PR features (for P= 8, different PL and PR
parameters) were given in Tables II–IV for Spamassasian,
Ling-Spam, and TREC corpuses, respectively. The
classification process was carried out by using the open
source data mining software package WEKA (Waikato
Environment for Knowledge Analysis), which is a
collection of machine-learning tools for data mining
purposes, including data preprocessing, feature selection,
classification, clustering, association rules, and visualiza-
tion [50].Figure 6. Histogram of (a) spam mesAs seen in Tables II–IV, the highest obtained average
accuracy of the Spamassasian corpus by shifted-1D-
LBPPL=6,PR=2 is 93.04%. The highest accuracy was achieved
by FLDA method for the Spamassasian corpus. It is 92.56%
by FT and RF for the Ling-Spam corpus data set by shifted-
1D-LBPPL=3,PR=5 features. The highest success rate for the
TREC data set is 95.15%, and it was obtained by using the
RF method with shifted-1D-LBPPL=1,PR=7. As seen in
Tables II–IV, the obtained accuracies are in an acceptable
range. The obtained accuracies are acceptable values based
on the results reported in the literature [5,44,51–53]. The
distinguishable powers of three data sets are strongly related
to each of the PL and PR parameters, which are important
parameters for detection of micro–macro patterns in email
texts. However, the main weakness of this study is the failure
to address how to determine the optimum values of PL and PR
parameters without trials. The obtained performance measures
with the most successful methods (FLDA, FT, and RF), spam
recall, precision, f-measure, MCC rates, and ROC area were
listed in Table V with the features obtained by various
combinations of PL and PR for the Spamassasian corpus, the
Ling-Spam, and the TREC corpuses.
As seen in Table V, optimum PL and PR values were
(PL= 1, PR= 7), (PL= 6, PR= 2) and (PL= 3, PR = 5) for
the TREC, the Spamassasian, and the Ling-Spam corpus
data sets, respectively, while P= 8. The obtained spam re-
call (95.2%, 93.2%, and 92.4% for three corpuses), which
is an indication of filter effectiveness [52], and spam preci-
sion (95.2%, 93.3%, and 92.5%), which is an indication of
filter safety [52], rates are also acceptable. As a summary,
the higher the recall, the fewer spam messages pass, and
the higher the precision, the less non-spam messages
blocked. The cost of precision is much higher than the re-
call measure. Therefore, the existence of lower precision is
that tending to delete spam from a bulk folder without
reading them and deleting non-spam emails is unaccept-
able. In that case, it is acceptable to allow higher recall
rather than having lower precision. In this study, precision
and recall measures were obtained almost equally for threesage and (b) non-spam message.
Security Comm. Networks (2016) © 2016 John Wiley & Sons, Ltd.
DOI: 10.1002/sec
Table II. Classification results for the Spamassasian corpus with different machine-learning methods with various values of PL and PR.
Model
PL = 0,
PR = 8
PL = 1,
PR = 7
PL = 2,
PR = 6
PL = 3,
PR = 5
PL = 4,
PR = 4
PL = 5,
PR = 3
PL = 6,
PR = 2
PL = 7,
PR = 1
PL = 8,
PR = 0
FLDA 90.45 91.89 92.19 91.53 91.53 91.62 93.04 92.48 91.65
FT 89.57 91.37 91.06 90.60 91.22 92.03 92.34 91.14 91.12
RF 90.16 91.07 90.47 90.99 91.32 91.60 92.19 91.27 91.73
BN 79.51 80.82 80.04 81.15 80.56 81.35 81.42 80.81 79.84
FLDA, Fisher linear discriminant analysis; FT, functional tree; RF, random forest; BN. BayesNet.
Table III. Classification results for Ling-Spam corpus with different machine-learning methods with various values of PL and PR (%).
Model
PL = 0,
PR = 8
PL = 1,
PR = 7
PL = 2,
PR = 6
PL = 3,
PR = 5
PL = 4,
PR = 4
PL = 5,
PR = 3
PL = 6,
PR = 2
PL = 7,
PR = 1
PL = 8,
PR = 0
FLDA 86.83 88.45 88.00 88.97 88.97 88.59 89.66 89.63 88.04
FT 89.94 90.28 91.66 92.56 92.39 90.80 91.56 91.01 90.87
RF 88.21 88.24 88.55 92.56 88.55 87.86 88.83 88.14 88.21
NB 77.35 77.11 77.32 77.49 77.42 77.32 77.39 77.18 77.01
FLDA, Fisher linear discriminant analysis; FT, functional tree; RF, random forest; BN. BayesNet.
Table IV. Classification results for TREC corpus with different machine-learning methods with various values of PL and PR (%).
Model
PL = 0,
PR = 8
PL = 1,
PR = 7
PL = 2,
PR = 6
PL = 3,
PR = 5
PL = 4,
PR = 4
PL = 5,
PR = 3
PL = 6,
PR = 2
PL = 7,
PR = 1
PL = 8,
PR = 0
FLDA 84.92 86.39 85.52 86.30 86.71 86.41 85.73 85.50 85.27
FT 86.70 89.38 85.08 86.63 84.75 85.98 81.62 83.56 84.02
RF 94.80 95.15 94.55 94.48 94.58 94.85 94.92 94.60 94.95
RT 89.33 89.74 88.84 89.21 89.03 89.83 89.21 88.98 89.58
BN 78.10 72.10 72.89 72.72 72.70 72.95 71.85 71.50 71.40
Table V. Results of the Spamassasian corpus (6047 total emails, 31% is spam), the Ling-Spam corpus (2893 total emails, 16% is
spam), and the TREC (37 822 total emails, 65.86% is spam) corpuses.
Features / Model Data set Precision Recall F-measure MCC ROCA
shifted-1D-LBPPL=1,PR=7 + RF TREC 0.952 0.952 0.951 0.892 0.990
shifted-1D-LBPPL=6,PR=2 + FLDA Spamassasian 0.933 0.932 0.932 0.843 0.970
shifted-1D-LBPPL=3,PR=5 + RF Ling-Spam 0.925 0.924 0.924 0.728 0.920
A novel approach for spam email detectionY. Kaya and Ö. F. Ertuğrulcorpuses, as seen in Table V. The obtained MMC, f-score,
and ROCA are in the acceptable range. The MCC is, in es-
sence, a correlation coefficient between the observed and
predicted binary classifications; it returns a value between
1 and +1. A coefficient of +1 represents a perfect predic-
tion. Acceptable MMC values were obtained for three data
sets (Table V). Other performance parameters, f-score and
ROCA were obtained in the acceptable ranges.
Recently, several different techniques have been ap-
plied to detect and filter the spam email. Table VI provides
a comparative study of the quantitative performance
achieved by employing our proposed algorithm, vis-à-vis
other algorithm reported in the literature for the
Spamassassian, the Ling-Spam, and the TREC corpuses.
It can be seen in Table VI that our proposed method
could produce a significant performance compared with
other studies in the literature. These obtained highSecurity Comm. Networks (2016) © 2016 John Wiley & Sons, Ltd.
DOI: 10.1002/secperformance measures may be because of the proposed,
shifted-1D-LBP, feature extraction method. Additionally,
it does not extract high-dimensional feature data set.
The main improvement of shifted-1D-LBP from
1D-LBP [46] is the selection of the neighbors that will be
thresholded with the center point in data. As seen in the re-
sults, different PL and PR values generate different patterns.
This is an important feature because the language of the
email or the habits of the user may change.
The major difference of the proposed method is that the
shifted-1D-LBP approach is based on the order of charac-
ters in a message, but previous studies depended on
blacklisting email senders, searching for keywords, and
statistical measures of some predefined words [52].
Another advantage of the proposed method is the number
of features that are extracted from the message depends
on the determined PL and PR values (2
PL+ PR). On the other
Table VI. Reported works on the Spamassassian, the Ling-Spam, and the TREC corpuses (%).
Author(s)/Year Model Data set Precision Recall ROCA F-score Accuracy
Androutsopoulos et al. (2000) [23] Naïve Bayes LingSpam 97.1 94.3 — — —
Sakkis et al. (2001) [51] Naïve Bayes LingSpam 99.0 82.4 — — —
Sakkis et al. (2001) [51] KNN LingSpam 97.4 88.6 — — —
Kumar et al. (2012) [54] Cluster based LingSpam 60.10 71.60 — — 89.31
Chuan et al. (2005) [55] LVQ Spamassassin 98.97 93.58 96.20 — —
Bratko et al. (2006) [44] Hidden Markov Spamassassin — — — — 97.46
Lai and Tsai (2004) [56] Naïve Bayes Spamassassin — — — — 88.76
Lai and Tsai (2004) [56] KNN Spamassassin — — — — 89.99
Lai and Tsai (2004) [56] SVM Spamassassin — — — — 92.28
Su et al. (2010) [6] Neural tree Spamassassin — — — — 89.15
Zhang et al. (2004) [24] Naïve Bayes Spamassassin — — 97.50 —
Bratko et al. (2006) [44] Hidden Markov TREC — — 98.35 — —
Goodman and Yih (2006) [36] Logistic regression TREC — — 95.30 — —
Su et al. (2010) [6] neural tree TREC — — — — 90.87
This study S-1D-LBP LingSpam 92.50 92.40 92.40 92.00 92.56
This study S-1D-LBP Spamassassin 93.30 93.20 93.20 97.00 93.04
This study S-1D-LBP TREC 95.20 95.20 95.10 99.00 95.15
A novel approach for spam email detection Y. Kaya and Ö. F. Ertuğrulhand, some methods such as n-gram or Bag of Word
methods extract a large number of features, which causes
many drawbacks such as cause an overfitting problem,
and furthermore, it increases the computational cost.
Therefore, it was used with feature selection algorithms,
which is an extra computational cost. Furthermore, another
outcome of the proposed method is that it can detect dif-
ferent patterns by simply picking up different PL and PR
parameters as seen in Figure 4. As a summary, these results
showed that the proposed method can be utilized in the
text-based studies successfully.6. CONCLUSIONS
The importance of the use of email communication is in-
creased nowadays, and it is used in nearly all lines of busi-
ness. The spams are a serious problem in this type of
communication that does not only affect normal users of
the internet but also causes a major problem for companies
and organizations. As a solution of this, some spam email-
detection methods have been used, such as blacklisting the
spam email senders, keyword searching, and statistical
measurements of some specific words. This research intro-
duces a novel feature extraction method for spam email de-
tection that is based on shifted-1D-LBP and that uses
relations between character sequence, and the formed
new feature depends on this order. The shifted-1D-LBP
is defined as an ordered set of binary comparisons of the
center value and its neighboring values. To demonstrate
the performance of the proposed method, three benchmark
corpora (Spamassasian, Ling-Spam, and TREC email cor-
pus) were used. The average classification accuracies of
the proposed method were 92.34%, 92.57%, and 95.15%,
respectively. The analysis and promising experimental re-
sults indicate that the proposed method was very competi-
tive with feature extraction method for spam emailfiltering. Additionally, this approach can be easily applied
to other natural languages and processing areas such as
language identification, categorization of texts in news-
groups, and identification of similar contents in social
networks.REFERENCES
1. Whittaker S, Bellotti V, Moody P. Introduction to this
special issue on revisiting and reinventing e-mail.
Human-Computer Interaction 2005; 20(1):1–9.
2. Carpinter J, Hunt R. Tightening the net: a review of
current and next generation spam filtering tools. Com-
puters & Security 2006; 25(8):566–578.
3. Çıltık A, Güngör T. Time-efficient spam e-mail filter-
ing using n-gram models. Pattern Recognition Letters
2008; 29(1):19–33.
4. Guzella TS, Caminhas WM. A review of machine
learning approaches to spam filtering. Expert Systems
with Applications 2009; 36(7):10206–10222.
5. Laorden C, Ugarte-Pedrero X, Santos I, Sanz B,
Nieves J, Bringas PG. On the study of
anomaly-based spam filtering using spam as repre-
sentation of normality. In Consumer Communica-
tions and Networking Conference (CCNC) 2012
IEEE; 693–695.
6. Su MC, Lo HH, Hsu FH. A neural tree and its
application to spam e-mail detection. Expert Systems
with Applications 2010; 37(12):7976–7985.
7. DeBarr D, Wechsler H. Spam detection using random
boost. Pattern Recognition Letters 2012; 33(10):
1237–1244.
8. Wu CH. Behavior-based spam detection using a
hybrid method of rule-based techniques and neuralSecurity Comm. Networks (2016) © 2016 John Wiley & Sons, Ltd.
DOI: 10.1002/sec
A novel approach for spam email detectionY. Kaya and Ö. F. Ertuğrulnetworks. Expert Systems with Applications 2009;
36(3):4321–4330.
9. Nakov PI, Dobrikov PM. Non-parametric SPAM
filtering based on kNN and LSA. In Proceedings of
the 33th National Spring Conference of the Bulgarian
Mathematicians Union, 2004 April; 1–4.
10. Chakravarty S. A survey on text classification
techniques for e-mail filtering. In Machine Learning
and Computing (ICMLC). Second International
Conference, 2010 February; IEEE; 32–36.
11. Tretyakov K. Machine learning techniques in spam
filtering. InData Mining Problem-oriented Seminar
MTAT 2004; 3:60–79.
12. Wang Q, Guan Y, Wang X. SVM-based spam filter
with active and online learning 2006. In TREC.
13. Lin JL. Detection of cloaked web spam by using tag-
based methods. Expert Systems with Applications
2009; 36(4):7493–7499.
14. Idris I, Selamat A, Omatu S. Hybrid email spam detec-
tion model with negative selection algorithm and dif-
ferential evolution. Engineering Applications of
Artificial Intelligence 2014; 28:97–110.
15. Lai CC. An empirical study of three machine learning
methods for spam filtering. Knowledge-Based Systems
2007; 20(3):249–254.
16. El-Alfy ESM, Abdel-Aal RE. Using GMDH-based
networks for improved spam detection and email
feature analysis. Applied Soft Computing 2011;
11(1):477–488.
17. Awad WA, ELseuofi SM. Machine learning methods
for e-mail classification. International Journal of
Computer Applications 2011; 16(1):0975–8887.
18. Idris I, Selamat A. Improved email spam detection
model with negative selection algorithm and particle
swarm optimization. Applied Soft Computing 2014;
22:11–27.
19. Li Y, Wen PP. Clustering technique-based least square
support vector machine for EEG signal classification.
Computer Methods and Programs in Biomedicine
2011; 104(3):358–372.
20. Blanzieri E, Bryl A. A survey of learning-based
techniques of email spam filtering. Artificial
Intelligence Review 2008; 29(1):63–92.
21. Schneider KM. A comparison of event models for
Naive Bayes anti-spam e-mail filtering. In Proceedings
of the Tenth Conference on European Chapter of the
Association for Computational Linguistics-Volume 1,
2003 April; 307–314.
22. Graham P. Better bayesian filtering. In Proceedings of
the 2003 Spam Conference, 2003, January; 11: 15–17.
23. Androutsopoulos I, Paliouras G, Michelakis E. Learning
to filter unsolicited commercial e-mail. (Technical Report
2004/2). NCSR “Demokritos”. Revised version.Security Comm. Networks (2016) © 2016 John Wiley & Sons, Ltd.
DOI: 10.1002/sec24. Zhang L, Zhu J, Yao T. An evaluation of statistical spam
filtering techniques.ACMTransactions onAsian Language
Information Processing (TALIP) 2004; 3(4):243–269.
25. Marsono MN, El-Kharashi MW, Gebali F. Targeting
spam control on middleboxes: spam detection based
on layer-3 e-mail content classification. Computer
Networks 2009; 53(6):835–848.
26. Wang XL. Learning to classify email: a survey. In
2005 International Conference on Machine Learning
and Cybernetics 2005; 9: 5716–5719
27. Sculley D, Wachman GM. Relaxed online SVMS for
spam filtering. Proceedings of the 30th Annual İnter-
national ACM SIGIR Conference on Research and
Development in İnformation Retrieval, 2007; 415–422.
28. Blanzieri E, Bryl A. Evaluation of the highest proba-
bility svm nearest neighbor classifier with variable
relative error cost. Proceedings of Fourth Conference
on Email and Anti-Spam, 2007; CEAS’2007; 5.
29. Soonthornphisaj N, Chaikulseriwat K, Tang-On P.
Anti-spam filtering: a centroid-based classification ap-
proach. Signal Processessing 2002; 2:1096–1099.
30. Sasaki M, Shinnou H. Spam detection using text clus-
tering. Proceedings of İnternational Conferenceon
Cyberworlds, 2005, CW2005; 316–319.
31. Medlock B. An adaptive approach to spam filtering on
a new corpus. Proceedings of the Third Conference on
Email and Anti-Spam, 2006, CEAS’2006.
32. Zhao W, Zhang Z. An email classification model based
on rough set theory. Proceedings of the 2005
İnternational Conference on Active Media Technol-
ogy, 2005; AMT05; 403–408.
33. Kaya Y, Yeşilova A, Tekin R. A rough set approach for
spam e-mail filtering. Electric-Electronic and Computer
Symposium Fırat University, 2011; 148–153.
34. Leiba B, Ossher J, Rajan VT, Segal R, Wegman M.
SMTP path analysis. Proceedings of second conference
on email and anti-spam, 2005, CEAS’2005.
35. Kaya Y, Ertuğrul ÖF, Tekin R. An expert spam
detection system based on extreme learning machine.
Computer Science 2014; 1(2):132–137.
36. Goodman J, Yih WT. Online discriminative spam filter
training. Proceedings of the Third Conference on
Email and Anti-Spam (CEAS) 2006 July; 2006.
37. Wu CH, Tsai CH. Robust classification for spam filter-
ing by back-propagation neural networks using
behavior-based features. Applied Intelligence 2009;
31(2):107–121.
38. Ying KC, Lin SW, Lee ZJ, Lin YT. An ensemble ap-
proach applied to classify spam e-mails. Expert Sys-
tems with Applications 2010; 37(3):2197–2201.
39. Yue X, Abraham A, Chi ZX, Hao YY, Mo H.
Artificial immune system inspired behavior-based
anti-spam filter. Soft Computing 2007; 11(8):729–740.
A novel approach for spam email detection Y. Kaya and Ö. F. Ertuğrul40. Hershkop S. Behavior-based email analysis with appli-
cation to spam detection. Ph D Thesis 2006. Available
at http://www1.cs.columbia.edu/~sh553/publications/
final-thesis.pdf Accessed: 12.20.2014.
41. SpamAssassin. Available from http://spamassassin.
apache.org/publiccorpus/, Last accessed 2014.
42. Androutsopoulos I, Koutsias J, Chandrinos KV,
Spyropoulos CD (2000a) An evaluation of naive
bayesian anti-spam filtering. In Proceedings of the
workshop on machine learning in the new information
age, 11th European conference on machine learning,
Potamias G, Moustakis V, van Someren M (eds).
ECML. arXiv: Barcelona, Spain, 2000; 9–17.
43. Cormack GV. Email spam filtering: a systematic
review. Foundations and Trends in Information
Retrieval 2007; 1(4):335–455.
44. Bratko A, Filipič B, Cormack GV, Lynam TR, Zupan
B. Spam filtering using statistical data compression
models. The Journal of Machine Learning Research;
2006; 7:2673–2698.
45. Ojala T, PietikainenM,Maenpaa T.Multiresolution gray-
scale and rotation invariant texture classification with
local binary patterns. IEEE Transactions on Pattern
Analysis and Machine Intelligence 2002; 24(7):971–987.
46. Kaya Y, Uyar M, Tekin R, Yıldırım S. 1D-local binary
pattern based feature extraction for classification of
epileptic EEG signals. Applied Mathematics and
Computation 2014; 243:209–219.
47. Biggio B, Fumera G, Pillai I, Roli F. A survey and exper-
imental evaluation of image spam filtering techniques.
Pattern Recognition Letters 2011; 32(10):1436–1446.
48. Laorden C, Ugarte-Pedrero X, Santos I, Sanz B,
Nieves J, Bringas PG. Study on the effectiveness of
anomaly detection for spam filtering. Information
Sciences 2014; 277:421–444.49. Sakkis G, Androutsopoulos I, Paliouras G, Karkaletsis
V, Spyropoulos CD, Stamatopoulos P. A memory-
based approach to anti-spam filtering for mailing lists.
Information Retrieval 2003; 6(1):49–73.
50. Witten IH, Frank E. Data Mining: Practical Machine
Learning Tools and Techniques. Morgan Kaufmann,
Elsevier, San Francisco, 2005.
51. Sakkis G, Androutsopoulos I, Paliouras G, Karkaletsis
V, Spyropoulos C, Stamatopoulos P. Stacking classi-
fiers for anti-spam filtering of e-mail. Proceedings of
Empirical Methods in Natural Language Processing
2001, EMNLP-2001; 44–50.
52. Kanaris I, Kanaris K, Stamatatos E. Spam detection
using character n-grams. In Advances in Artificial Intel-
ligence, Antoniou G, Potamias G, Spyropoulos C,
Plexousakis D (eds). Springer Berlin Heidelberg: Berlin,
2006; 95–104.
53. Sabri AT, Mohammads AH, Al-Shargabi B, Hamdeh
MA. Developing new continuous learning approach
for spam detection using artificial neural network
(CLA_ANN). European Journal of Scientific Research
2010; 42(3):525–535.
54. Kumar NS, Rana DP, Mehta RG. Detecting e-mail
spam using spam word associations. International
Journal of Emerging Technology and Advanced
Engineering 2012; 2(4):222–226.
55. Chuan Z, Xianliang L, Mengshu H, Xu Z. A
LVQ-based neural network anti-spam email approach.
ACM SIGOPS Operating Systems Review 2005;
39(1):34–39.
56. Lai CC, Tsai MC. An empirical performance compar-
ison of machine learning methods for spam e-mail
categorization. In Hybrid Intelligent Systems, 2004.
HIS’04. Fourth International Conference, 2004
December; 44–48, IEEE.Security Comm. Networks (2016) © 2016 John Wiley & Sons, Ltd.
DOI: 10.1002/sec
